# 🔧 데이터베이스 문제 해결 완료

## 문제 발견

테스트 결과, **Google Apps Script에 코드가 제대로 배포되지 않았습니다**.

### 에러 내용
```
ReferenceError: SPREADSHEET_ID is not defined
```

이 에러는 Apps Script 에디터에 코드가 없거나, 이전 버전이 배포되어 있다는 의미입니다.

---

## ✅ 해결 방법

### **반드시 아래 파일을 읽고 따라하세요:**

👉 **[SETUP_INSTRUCTIONS_KR.md](./SETUP_INSTRUCTIONS_KR.md)** 👈

이 파일에 단계별 해결 방법이 자세히 설명되어 있습니다.

---

## 🎯 요약 (5분 안에 해결)

1. **구글 시트 열기**: https://docs.google.com/spreadsheets/d/1eURuprOb-jWrsBTXVdeUYkV-tV8g3wC6KCIeZGHw3Qs/edit

2. **Apps Script 열기**: 확장 프로그램 → Apps Script

3. **코드 전체 교체**:
   - 기존 코드 모두 삭제
   - `google-apps-script.gs` 파일 내용 전체 복사 & 붙여넣기
   - 저장 (Cmd+S)

4. **테스트 실행**:
   - 함수 선택: `testConnection`
   - 실행 버튼 클릭
   - 로그 확인: `✅ 스프레드시트 연결 성공!`

5. **재배포**:
   - 배포 → 배포 관리 → 기존 배포 보관처리
   - 배포 → 새 배포 → 웹 앱
   - 설정: 실행 계정(나), 액세스 권한(모든 사용자)
   - 새 웹 앱 URL 복사

6. **URL 업데이트**:
   - `components/sections/CTA.tsx` 17번 라인
   - 새 URL로 변경
   - 저장

7. **테스트**:
   - `test-form.html` 브라우저에서 열기
   - 또는 http://localhost:3000 접속
   - 폼 제출 후 구글 시트 확인

---

## 📁 관련 파일들

### 1. **SETUP_INSTRUCTIONS_KR.md** ⭐ 가장 중요!
   - 전체 설정 가이드
   - 스크린샷 포함 단계별 설명
   - 문제 해결 방법

### 2. **google-apps-script.gs**
   - Apps Script 에디터에 붙여넣을 코드
   - 이 파일의 전체 내용을 복사하세요

### 3. **test-form.html**
   - 독립적인 테스트 파일
   - 브라우저에서 직접 열어서 테스트 가능
   - 실시간 로그 표시

### 4. **components/sections/CTA.tsx**
   - 실제 랜딩 페이지 폼
   - 17번 라인에 Google Script URL 설정

### 5. **GOOGLE_SHEETS_SETUP.md**
   - 일반적인 설정 가이드
   - 이메일 알림 설정 방법 포함

---

## 🧪 테스트 방법 3가지

### 방법 1: 테스트 HTML (가장 빠름)
```bash
# 브라우저에서 열기
open test-form.html
```
또는 파일을 더블클릭하여 브라우저에서 엽니다.

### 방법 2: 실제 랜딩 페이지
```bash
npm run dev
```
http://localhost:3000 접속 → 폼 작성 → 제출

### 방법 3: cURL 명령어
```bash
curl -X POST "[새_배포_URL]" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "테스트",
    "phone": "010-1234-5678",
    "email": "test@example.com",
    "dogBreed": "골든 리트리버, 3세",
    "issue": "테스트입니다"
  }'
```

---

## ✨ 성공 확인 체크리스트

- [ ] Apps Script `testConnection` 실행 → "✅ 스프레드시트 연결 성공!"
- [ ] 구글 시트에 보라색 헤더 생성됨
- [ ] 테스트 데이터 제출 → 구글 시트에 새 행 추가됨
- [ ] 시간이 한국 시간으로 표시됨 (예: 2024-12-14 11:30:45)
- [ ] 상태 열에 "신규" 자동 입력됨

---

## 🎨 구글 시트 예상 결과

```
┌─────────────────────┬────────┬───────────────┬──────────────────┬─────────────────────┬──────────────────┬────────┐
│ 접수 시간           │ 이름   │ 연락처        │ 이메일           │ 강아지 품종/나이    │ 문제 행동 설명   │ 상태   │
├─────────────────────┼────────┼───────────────┼──────────────────┼─────────────────────┼──────────────────┼────────┤
│ 2024-12-14 11:30:45 │ 테스트 │ 010-1234-5678 │ test@example.com │ 골든 리트리버, 3세  │ 테스트입니다     │ 신규   │
└─────────────────────┴────────┴───────────────┴──────────────────┴─────────────────────┴──────────────────┴────────┘
```

**헤더 스타일:**
- 배경: 보라색 (#6B46C1)
- 글자: 흰색
- 굵게 표시

---

## 🚨 여전히 안 되는 경우

다음 정보를 확인하세요:

1. **Apps Script 로그 확인**:
   - Apps Script 에디터 → 보기 → 로그
   - 에러 메시지 확인

2. **브라우저 Console 확인**:
   - F12 키 → Console 탭
   - `📤 전송 데이터:` 로그 확인
   - 에러 메시지 확인

3. **배포 설정 재확인**:
   - 실행 계정: **나**
   - 액세스 권한: **모든 사용자**

4. **URL 확인**:
   - `/exec`로 끝나야 함 (NOT `/dev`)

---

## 📞 다음 단계

1. `SETUP_INSTRUCTIONS_KR.md` 파일을 열어서 단계별로 따라하세요
2. 각 단계마다 체크리스트를 확인하세요
3. 테스트 후 구글 시트에서 데이터를 확인하세요

**파일을 열려면:**
```bash
# VSCode에서 열기
code SETUP_INSTRUCTIONS_KR.md

# 또는 기본 텍스트 에디터로 열기
open SETUP_INSTRUCTIONS_KR.md
```

---

## 💡 디버깅 팁

### 콘솔 로그 보는 법
1. 브라우저에서 F12 키
2. Console 탭 선택
3. 폼 제출
4. 다음 로그들을 확인:
   - `📤 전송 데이터:` → 보내는 데이터
   - `✅ 전송 완료:` → 응답 상태

### Apps Script 로그 보는 법
1. Apps Script 에디터
2. 상단 메뉴: **보기** → **로그**
3. 또는 **실행** → **실행 로그**

---

**🎯 목표: 5분 안에 데이터베이스 연동 완료!**

모든 단계를 따라하면 반드시 해결됩니다. 화이팅! 💪
